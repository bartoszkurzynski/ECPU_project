---
title: "brudnopis"
output: pdf_document
date: "2025-01-31"
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax
for authoring HTML, PDF, and MS Word documents. For more details on
using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that
includes both content as well as the output of any embedded R code
chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to
prevent printing of the R code that generated the plot.

```r
# Lista wymaganych pakietów
required_packages <- c(
  "dplyr", "ggplot2", "finalfit", "VIM", "validate", 
  "errorlocate", "tidyverse", "ggcorrplot", "forcats", "ggthemes"
)

# Instalacja brakujących pakietów
install_if_missing <- function(packages) {
  new_packages <- packages[!(packages %in% installed.packages()[,"Package"])]
  if (length(new_packages)) install.packages(new_packages, dependencies = TRUE)
}

install_if_missing(required_packages)

# Załadowanie pakietów
lapply(required_packages, library, character.only = TRUE)
```

#1. Wstęp

##1.1. Cel projektu

Celem projektu jest analiza czynników wpływających na wyniki uczniów w
egzaminach. Badanie ma na celu zidentyfikowanie, które zmienne, takie
jak liczba godzin nauki, frekwencja czy wsparcie rodziny, mają
największy wpływ na sukces akademicki. Wyniki analizy mogą pomóc w
optymalizacji strategii edukacyjnych oraz wdrożeniu skutecznych metod
wsparcia dla uczniów o niższych wynikach.

###1.2. Opis problemu

Osiągnięcia akademickie uczniów są determinowane przez wiele czynników –
zarówno indywidualnych, jak i środowiskowych. Trudności w nauce, poziom
zaangażowania rodziców, dostęp do zasobów edukacyjnych czy aktywności
pozalekcyjne mogą znacząco wpływać na ostateczne wyniki. Analiza tych
czynników pozwoli na lepsze zrozumienie zależności i wsparcie uczniów w
poprawie wyników.

###1.3. Znaczenie analizy wyników uczniów

Zrozumienie czynników wpływających na wyniki egzaminacyjne jest istotne
z kilku powodów:

Optymalizacja strategii nauczania – analiza wyników może pomóc
nauczycielom i decydentom edukacyjnym w dostosowaniu metod nauczania do
potrzeb uczniów.

Wsparcie dla uczniów w trudnej sytuacji – identyfikacja kluczowych
czynników umożliwia wdrożenie skutecznych programów pomocy.

Poprawa efektywności edukacji – lepsze zrozumienie procesów nauczania
pozwala na skuteczniejsze zarządzanie systemem edukacyjnym.

##2. Opis danych

###2.1. Źródło danych

Dane wykorzystane w analizie pochodzą z anonimowego zbioru danych
dotyczącego uczniów szkół średnich. Zawierają one informacje na temat
wyników egzaminacyjnych oraz czynników potencjalnie wpływających na
sukces akademicki.

###2.2. Struktura zbioru danych

Zbiór danych zawiera następujące kolumny:

Zmienne numeryczne: Liczba godzin nauki, frekwencja, liczba sesji
korepetycji, wynik egzaminu itp.

Zmienne kategoryczne: Poziom zaangażowania rodziców, dostęp do zasobów
edukacyjnych, typ szkoły, aktywności pozalekcyjne itp.

###2.3. Opis zmiennych

Każda z analizowanych zmiennych pełni określoną funkcję w kontekście
analizy wyników uczniów. Główne zmienne to:

Hours_Studied – liczba godzin nauki tygodniowo.

Attendance – procentowa frekwencja na zajęciach.

Tutoring_Sessions – liczba godzin spędzonych na korepetycjach.

Parental_Involvement – poziom zaangażowania rodziców (Low, Medium,
High).

Access_to_Resources – dostęp do zasobów edukacyjnych (Low, Medium,
High).

Motivation_Level – poziom motywacji ucznia.

Previous_Scores – wyniki ucznia z poprzednich egzaminów.

Exam_Score – wynik końcowy z egzaminu.

Dane te zostaną poddane dalszej analizie w celu określenia ich wpływu na
końcowe wyniki uczniów.

##3. Przygotowanie danych

###3.1. Analiza zależności między zmiennymi

Analiza korelacji i zależności między zmiennymi pozwala określić, które
czynniki mają największy wpływ na wyniki egzaminacyjne. Przeprowadzona
analiza obejmuje obliczenie współczynników korelacji Spearmana dla
kluczowych zmiennych oraz ich wpływu na wynik końcowy.

``` r
#obliczenie korelacji Spearmana dla wielu zmiennych 
cor_vars <- c("Hours_Studied", "Attendance", "Tutoring_Sessions",
"Parental_Involvement", "Access_to_Resources", "Motivation_Level",
"Internet_Access", "Previous_Scores", "Family_Income",
"Teacher_Quality", "Peer_Influence", "Physical_Activity")

cor_results <- sapply(cor_vars, function(var) {
cor.test(czyste_dane[[var]],
czyste_dane$Exam_Score, method = "spearman")$estimate })
```

``` r
#Wyświetlenie wyników korelacji 
cor_results
```

``` r
#Plot Missing-ness
data %>%
  dplyr::select(Hours_Studied,Attendance, Parental_Involvement,Access_to_Resources, Extracurricular_Activities, Sleep_Hours, 
                Previous_Scores, Motivation_Level, Internet_Access, Tutoring_Sessions, Family_Income, Teacher_Quality, School_Type,
                Peer_Influence, Physical_Activity, Learning_Disabilities, Parental_Education_Level, Distance_from_Home, Gender) %>%
  finalfit::missing_plot()
```

###3.2. Czyszczenie danych i imputacja brakujących wartości

Przed przystąpieniem do analizy konieczne było usunięcie brakujących
wartości oraz poprawienie błędów w danych.

``` r
#Sprawdzenie brakujących danych library(finalfit)
  data %\>% dplyr::select(Hours_Studied, Attendance, Parental_Involvement,
    Access_to_Resources, Extracurricular_Activities, Sleep_Hours,
    Previous_Scores, Motivation_Level, Internet_Access, Tutoring_Sessions,
    Family_Income, Teacher_Quality, School_Type, Peer_Influence,
    Physical_Activity, Learning_Disabilities, Parental_Education_Level,
    Distance_from_Home, Gender) %\>% 
finalfit::missing_pattern()

#Imputacja danych metodą hotdeck library(VIM) data_no_error \<-
hotdeck(data)


#Sprawdzenie czy imputacja usunęła brakujące wartości 
data_no_error %\>%
finalfit::missing_plot()
```

###3.3. Grupowanie danych i transformacja zmiennych

Dane zostały podzielone na grupy w celu ułatwienia analizy i
interpretacji wyników.

``` r
#Uszeregowanie danych w grupach
czyste_dane_temp$grupa1 <- factor(czyste_dane_temp$grupa1, levels = c("poniżej 16", "16-23", "powyżej 23"))
#wykres
ggplot(czyste_dane_temp, aes(x = grupa1, y = Exam_Score, fill = grupa1)) +
  geom_boxplot() +
  theme_minimal() +
  labs(title = "Wpływ godzin nauki na wynik egzaminu",
       x = "Ilość godzin nauki",
       y = "Wynik egzaminu") +
  scale_fill_brewer(palette = "Set4")

# Podział kolumny Exam_Score na grupy
czyste_dane_temp2 <- czyste_dane %>%
  mutate(grupa2 = case_when(
    Exam_Score < 60 ~ "2.0",                          # poniżej 60
    Exam_Score >= 60 & Exam_Score <= 65 ~ "3.0",      # 60 do 65
    Exam_Score >= 66 & Exam_Score <= 70 ~ "3.5",      # 66 do 70
    Exam_Score >= 71 & Exam_Score <= 80 ~ "4.0",      # 71 do 80
    Exam_Score >= 81 & Exam_Score <= 90 ~ "4.5",      # 81 do 90
    Exam_Score > 90 ~ "5.0",                          # powyżej 90
    TRUE ~ "Brak danych"                              # "Brak danych", by uniknąć NA
  ))
#ustawianie pogrupowanych danych jako factor
czyste_dane_temp2 <- czyste_dane_temp2 %>%
  mutate(grupa2 = factor(grupa2, levels = c("2.0", "3.0", "3.5", "4.0", "4.5", "5.0")))
```

##4. Eksploracyjna Analiza Danych (EDA)

###4.1. Rozkład wyników egzaminacyjnych

Analiza rozkładu wyników egzaminacyjnych pozwala ocenić, jak
zróżnicowane są osiągnięcia uczniów oraz czy dane zawierają ewentualne
wartości odstające.

``` r
# Histogram wyników egzaminacyjnych
ggplot(czyste_dane, aes(x = Exam_Score)) +
  geom_histogram(bins = 20, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Rozkład wyników egzaminacyjnych",
       x = "Wynik egzaminu",
       y = "Liczba uczniów") +
  theme_minimal()
```

###4.2. Analiza korelacji między zmiennymi

W celu oceny, które zmienne są najsilniej powiązane z wynikami
egzaminacyjnymi, oszcowano model regresji liniowej.

``` r
# Regresja liniowa z wszystkimi czynnikami
model <- lm(Exam_Score ~ Hours_Studied + Attendance + Parental_Involvement + 
              Access_to_Resources + Extracurricular_Activities + Sleep_Hours + 
              Previous_Scores + Motivation_Level + Internet_Access + Tutoring_Sessions + 
              Family_Income + Teacher_Quality + School_Type + Peer_Influence + 
              Physical_Activity + Learning_Disabilities + Parental_Education_Level + 
              Distance_from_Home + Gender, 
            data=czyste_dane)
            
summary(model)
```

###4.3. Wpływ poszczególnych czynników na wyniki uczniów

Przeanalizowano wpływ kluczowych czynników, takich jak liczba godzin
nauki, frekwencja, dostęp do zasobów edukacyjnych oraz wsparcie rodziców
na wyniki egzaminacyjne.

``` r
# Boxplot: Wpływ godzin nauki na wynik egzaminu
ggplot(czyste_dane, aes(x = grupa1, y = Exam_Score, fill = grupa1)) +
  geom_boxplot() +
  labs(title = "Wpływ liczby godzin nauki na wynik egzaminu",
       x = "Liczba godzin nauki",
       y = "Wynik egzaminu") +
  theme_minimal()
```

``` r
# Boxplot: Wpływ frekwencji na wynik egzaminu
ggplot(czyste_dane, aes(x = grupa2, y = Attendance, fill = grupa2)) +
  geom_boxplot() +
  labs(title = "Zależność wyniku egzaminu od frekwencji",
       x = "Ocena końcowa",
       y = "Frekwencja (%)") +
  theme_minimal()
```

``` r
# Boxplot: Wpływ zaangażowania rodziców na wynik egzaminu
ggplot(czyste_dane, aes(x = Parental_Involvement, y = Exam_Score, fill = Parental_Involvement)) +
  geom_boxplot() +
  labs(title = "Wpływ zaangażowania rodziców na wyniki uczniów",
       x = "Zaangażowanie rodziców",
       y = "Wynik egzaminu") +
  theme_minimal()
```
